<script type="text/ng-template" id="product.html">
    <div>
        <div class="col-xs-12 cart-tile-heading">
            <h2>
                {{product.name}}
            </h2>
        </div>
        <div class="col-xs-12 cart-tile-body">
            <p class="cart-tile-description">
                {{product.description}}
            </p>

            <div class="promotion">
                <div ng-if="promotion" class="starburst" data-promotion="-{{promotion.percentOff}}%" style="right: 10%">
                            <span>
                                <span>
                                    <span>

                                    </span>
                                </span>
                            </span>
                </div>
            </div>

            <img class="img-circle product-tile-image" ng-src="/app/imgs/{{product.name}}.jpg"></img>
            <div class="row">
                <div class="col-xs-12 mb-5">
                    <h1>{{product.price | currency}}</h1>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-12 mb-5">
                    <h1>Reviews</h1>
                    <div ng-repeat="r in reviews" class="review-box mb-5 pa-5">
                        <b>{{formatString(r.customerName)}}</b><br>
                        <i>{{formatDate(r.dateTime)}}</i><br>
                        Rating: {{r.rating}}/5
                        <hr>
                        {{formatString(r.reviewText)}}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" type="button" ng-click="close()">Close</button>
    </div>
</script>

<div class="container container-cards-pf">
    <!-- Search form -->
    <!--form-inline md-form mr-auto mb-4-->
    <form class="form-inline d-inline" id="search-form">
        <input id="search-input" class="mr-sm-2" type="text" placeholder="Search" aria-label="Search"
               ng-model="searchCriteria">
        <button id="search-submit" mdbBtn size="sm" color="elegant" rounded="true" class="btn btn-primary ml-20"
                mdbWavesEffect type="submit"
                ng-click="productsSearch(searchCriteria)">Search
        </button>
    </form>
    <div class="row cart-flex">
        <div ng-repeat="item in products" class="col-md-4 col-sm-6 col-xs-12 mb-20">
            <div class="row cart-tile">
                <div class="col-xs-12 cart-tile-heading">
                    <h2>
                        {{item.product.name}}
                    </h2>
                </div>
                <div class="col-xs-12 cart-tile-body">
                    <p class="cart-tile-description">
                        {{item.product.description}}
                    </p>
                    <div class="promotion">
                        <div ng-if="getProductPromotion(item.product.itemId)" class="starburst"
                             data-promotion="-{{getProductPromotion(item.product.itemId).percentOff}}%">
                            <span>
                                <span>
                                    <span>

                                    </span>
                                </span>
                            </span>
                        </div>
                        <img class="img-responsive img-circle cart-tile-image promotion" data-promo="20"
                             ng-src="/app/imgs/{{item.product.name}}.jpg"
                             ng-click="openProductDetails(item.product, getReviews(item.product.itemId), getProductPromotion(item.product.itemId))">
                        </img>
                    </div>
                    <div class="row">
                        <div class="col-xs-6 mb-5">
                            <h1>Price: <br>{{item.product.price | currency}}</h1>
                        </div>

                        <div class="col-xs-6 mb-5 text-right" ng-if=getRating(item.product.itemId)>
                            <h1>Rating: <br>{{getRating(item.product.itemId)}}/5</h1>
                        </div>

                        <div class="col-xs-12 pb-10">
                            <form class="form-inline d-inline">
                                <div class="form-group">
                                    <select name="quan" ng-model="item.quantity" class="form-control" id="quan">
                                        <option value="1" selected>1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                    </select>

                                </div>
                                <button class="btn btn-primary ml-10" ng-click="addToCart(item)" type="submit">
                                    Add To Cart
                                </button>
                            </form>
                            <div ng-if="item.product.availability.quantity > 0" style="float:right"><label
                                    title="{{item.product.availability.quantity}} in our store in {{item.product.availability.location}}"
                                    class="label label-{{item.product.availability.quantity < 15 ? 'warning' : 'primary'}}">{{item.product.availability.quantity}}
                                left!</label>
                                <a target="_blank" href="{{item.product.availability.link}}">&nbsp;<span
                                        class="fa fa-map-marker fa-lg"></span></a>
                            </div>

                            <div ng-if="item.product.availability.quantity == 0" class="text-danger"
                                 style="float:right"><span class="fa fa-warning fa-lg"></span>&nbsp;Not in Stock
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
